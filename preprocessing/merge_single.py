import pandas as pd
import os

# Function to select samples with a maximum of 10,000 or the maximum available
def select_samples(data, num_samples=10000):
    return data.sample(n=min(num_samples, len(data)), random_state=42)


merged_data = pd.DataFrame()

directory = 'csv/labelled'
file_paths = []
# List of file paths
for root, dirs, files in os.walk(directory):
    for filename in files:
        file_paths.append(os.path.join(root, filename))
        
# Loop through each file path
for file_path in file_paths:
    # Load the CSV file into a DataFrame
    df = pd.read_csv(file_path)
    sample_df = select_samples(df)
    sample_df.fillna(0, inplace=True)
    # Concatenate the data to the merged DataFrame
    merged_data = pd.concat([merged_data, sample_df], ignore_index=True)

merged_dir = 'csv/signle_data/'
os.makedirs(merged_dir, exist_ok=True)
# Save the merged data to a new CSV file
merged_file_path = os.path.join(merged_dir, 'merged_data.csv')
merged_data.to_csv(merged_file_path, index=False)
