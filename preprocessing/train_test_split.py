import os
import pandas as pd
from sklearn.model_selection import train_test_split

def select_samples(data, num_samples=10000):
    return data.sample(n=min(num_samples, len(data)), random_state=2023)


directory = 'csv/labelled'
# Define the number of samples to select
num_samples = 10000

# Define the ratio for splitting (9:1)
test_size = 0.1
file_paths = []
# List of file paths
for root, dirs, files in os.walk(directory):
    for filename in files:
        file_paths.append(os.path.join(root, filename))


# Create directories if they don't exist
train_dir = 'csv/1000/9-1/train'
test_dir = 'csv/1000/9-1/test'
os.makedirs(train_dir, exist_ok=True)
os.makedirs(test_dir, exist_ok=True)

# Loop through each file path
for file_path in file_paths:
    # Load the CSV file into a DataFrame
    df = pd.read_csv(file_path)
    sample_df = select_samples(df)
    # Split the data into training and testing sets
    train_data, test_data = train_test_split(sample_df, test_size=test_size, random_state=42)

    # Save the training and testing sets to new CSV files in the specified directories
    train_file_path = os.path.join(train_dir, os.path.basename(file_path))
    test_file_path = os.path.join(test_dir, os.path.basename(file_path))

    train_data.to_csv(train_file_path, index=False)
    test_data.to_csv(test_file_path, index=False)

    print(f"Split {file_path} into {train_file_path} (train) and {test_file_path} (test).")
