import pandas as pd
import os
import sys

if __name__ == '__main__':
    folder_path = sys.argv[1]
    out_folder = sys.argv[2]
    filenames = []
    
    labels = {"mcfp-normal.csv": 0, "dridex.csv": 1,
              "trickbot.csv": 2, "vawtrak.csv": 3,
              "miuref.csv": 4, "zeus.csv": 5,
              "hancitor.csv": 6, "zeus-panda.csv": 7, 
              "dreambot.csv": 8, "gootkit.csv": 9}

    for root, dirs, files in os.walk(folder_path):
        for filename in files:
            filenames.append(os.path.join(root, filename))
            # label = int(input(f"{filename}: "))
            data = pd.read_csv(filenames[-1])
            data['label'] = [labels[filename]] * data.shape[0]
            data.to_csv(out_folder + f'/{filename}', index=False)

    print(filenames)
