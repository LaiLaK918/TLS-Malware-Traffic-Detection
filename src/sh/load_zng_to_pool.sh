#!/bin/bash

# Create a zed pool to load zng files converted
zed_pool_name=$3

# Create a zed pool
zed create -orderby ts:desc "$zed_pool_name"

# Use created pool
zed use "$zed_pool_name"

# Get all .zng files in the destination folder
zng_files=("$destination_folder"/*.zng)

# Loop through each .zng file and run zed load
for zng_file in "${zng_files[@]}"; do
    echo "Adding $zng_file to pool $zed_pool_name"
    # Construct the command to run zed load for each .zng file
    zed_load_command="zed load $zng_file"
    
    # Execute the zed load command
    eval "$zed_load_command"
    echo "$zng_file has been added to $zed_pool_name"
done

echo "All files added to pool $zed_pool_name"
