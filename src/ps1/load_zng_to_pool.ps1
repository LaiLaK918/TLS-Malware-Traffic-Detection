$directory = $args[0]
$pattern = $args[1]
$pool_name = $args[2]
$files = Get-ChildItem -Path $directory -Recurse | Where-Object { $_.Name -ilike "*$pattern*" }

zed use $pool_name

foreach ($file in $files) {
    $fileName = $file.FullName
    Write-Host "Processing file: $fileName"
    # Replace the following command with your specific command using the file name
    zed load $fileName
}
